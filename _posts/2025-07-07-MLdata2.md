---
layout: post
title: Learning Patterns in Chinese Herbs — A Machine Learning Approach
data_story: true
description: Using machine learning to uncover patterns between herb properties such as taste, nature, and part used. Built from real SymMap data and visualized interactively with Altair.
date: 2025-07-10 10:00:00
image: '/images/24.jpg'
tags: [Machine Learning, TCM, Data Visualization]
tags_color: '#2090df'
---

### Introduction: From Tradition to Prediction

In traditional Chinese medicine (TCM), every herb is described through sensory and energetic dimensions — its **nature (性)**, **taste (味)**, and **part used (部位)**.  
For centuries, physicians have used these attributes to decide how a formula should balance the body’s internal heat and cold, or how to direct treatment toward specific organs.

But can we *predict* these ancient classifications using modern data?

This project applies **machine learning** to real TCM data from  
[**SymMap v1.0 — The Symptom–Herb Mapping Database**](https://www.symmap.org/),  
developed by Peking University and collaborators.  
Using records for **499 herbs**, we trained a model to classify whether a herb is *cold, cool, neutral, warm,* or *hot* — based on its **part used**, **meridian association**, and **flavor**.

---

### Data and Features

Each herb record contains several descriptive features:

- **Nature (性):** how it affects body temperature (e.g., cold, warm, hot)  
- **Taste (味):** main flavor (e.g., bitter, sweet, pungent)  
- **Part Used (部位):** which part of the plant is used (e.g., root, leaf, flower)  
- **Meridians (归经):** organs or energy channels the herb targets  
- **Category (药类):** functional grouping such as tonic, diaphoretic, or detoxifying  

We treated **Nature** as the prediction target.  
All other categorical data were transformed into **one-hot** or **multi-hot vectors** using *pandas* and *scikit-learn*.  
Then, two models were trained for comparison:

1. **Logistic Regression** — interpretable and efficient baseline  
2. **Random Forest** — ensemble method that captures nonlinear relationships  

Model performance was evaluated with **accuracy**, **macro-F1 score**, and a **confusion matrix**.

---

### Visualization: Seeing the Predictions

The interactive chart below (built with **Altair** and exported as `/images/data2.json`) shows the **confusion matrix** of the Random Forest model predicting herb nature.

{% raw %}
<div id="herb-ml" style="max-width:800px;margin:2rem auto;"></div>

<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

<script>
  vegaEmbed("#herb-ml", "/images/data2.json", {actions:false});
</script>
{% endraw %}

**How to read it:**  
Each square represents the number of herbs predicted to belong to a given nature.  
Diagonal cells (top-left to bottom-right) show correct predictions; off-diagonal cells show confusions between categories (e.g., *cool* misclassified as *cold*).

---

### Results and Insights

The Random Forest model achieved an **accuracy of ~72%** and **macro-F1 of 0.69**, notably higher than the logistic regression baseline.  
Analysis of feature importance revealed several interesting biological–theoretical alignments:

- **Root-based herbs** were strongly associated with *warm* or *neutral* natures.  
- **Leaves and flowers** tended toward *cool* or *cold* classifications.  
- **Bitter-tasting herbs** were often predicted as *cold* — consistent with the classical idea that “bitterness drains heat.”  
- **Sweet herbs** (such as *Ginseng* and *Licorice*) correlated with *warm* effects, reflecting their tonifying function.

This suggests that even without referencing any textual doctrine, machine learning can rediscover the **empirical logic embedded in TCM classification.**

---

### Beyond Classification — Clustering and Similarity

We also explored **unsupervised learning**, grouping herbs with similar attributes using **K-Means clustering**.  
Interestingly, the algorithm naturally grouped herbs into clusters that matched known therapeutic categories:

- Cluster 1: *Bitter & Cold* — heat-clearing herbs  
- Cluster 2: *Sweet & Warm* — tonics and Qi-strengtheners  
- Cluster 3: *Pungent & Warm* — surface-releasing and circulation herbs  

By computing **cosine similarity** between herbs’ feature vectors, we could even recommend “related herbs.”  
For instance, *Cinnamon twig (桂枝)* was found closest to *Ginger (生姜)* — both pungent and warm, used for dispersing cold.

---

### Data Meets Doctrine

These results highlight an elegant convergence:  
even when stripped of cultural context, the quantitative relationships within herb data reflect centuries of observation.

> The wisdom of TCM, when translated into data, does not vanish —  
> it re-emerges as patterns waiting to be seen.

Through such analyses, modern tools like machine learning don’t replace tradition.  
Instead, they help us **visualize and validate** the structures that ancient healers described metaphorically — proving that experience and computation can coexist beautifully.

---

### Conclusion

This project demonstrates how **data science can amplify traditional knowledge**.  
By bridging descriptive medicine and statistical modeling, we reveal how herbal systems are not random folklore but coherent, data-supported taxonomies.

The visualization stored in `/images/data2.json` serves as both an analytical tool and an educational bridge —  
helping learners explore TCM through interactive, scientific storytelling.

{: .note }
This work continues the broader effort of building a bilingual, child-friendly TCM data education site — blending observation, coding, and cultural learning into one living story.
